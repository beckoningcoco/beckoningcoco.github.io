<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>梦落芳华</title><meta name="author" content="beckoningcoco"><meta name="copyright" content="beckoningcoco"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="世界好吵，让我帮你捂耳朵吧">
<meta property="og:type" content="website">
<meta property="og:title" content="梦落芳华">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="梦落芳华">
<meta property="og:description" content="世界好吵，让我帮你捂耳朵吧">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/%E5%A4%B4%E5%83%8F.png">
<meta property="article:author" content="beckoningcoco">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/%E5%A4%B4%E5%83%8F.png"><link rel="shortcut icon" href="/img/%E5%A4%B4%E5%83%8F.png"><link rel="canonical" href="http://example.com/page/4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '梦落芳华',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2025-07-23 14:38:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script><link rel="stylesheet" href="APlayer.min.css"><div id="aplayer"></div><script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js" async></script><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/readPercent.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/%E5%A4%B4%E5%83%8F.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">136</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 影音</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于作者</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogsEE240625 (8).jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">梦落芳华</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 影音</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/comment/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于作者</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">梦落芳华</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/beckoningcoco" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:995587764@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-content left"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0717 (6).jpg" onerror="this.onerror=null;this.src='/null'" alt="醋溜土豆丝"></div><div class="recent-post-info"><a class="article-title" href="/2025/05/19/%E5%B9%B2%E9%A5%AD/%E9%86%8B%E6%BA%9C%E5%9C%9F%E8%B1%86%E4%B8%9D/" title="醋溜土豆丝"><div class="article-title-link">醋溜土豆丝</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-05-19T01:05:48.000Z" title="发表于 2025-05-19 09:05:48">2025-05-19</time></span></div></div></div><a class="article-content" href="/2025/05/19/%E5%B9%B2%E9%A5%AD/%E9%86%8B%E6%BA%9C%E5%9C%9F%E8%B1%86%E4%B8%9D/" title="醋溜土豆丝"><div class="article-content-text">做法
土豆切丝，放清水备用，青椒切丝，切葱蒜沫，小米辣切段
煮锅水，等水开，下土豆丝过开水，加一些白醋，等待10来秒，捞出
下油，炒葱蒜沫，出香，加一些白醋
下土豆丝+青椒丝，翻炒，加生抽老抽，盐调味。
翻炒几分钟即可，出锅前勾芡 淀粉水 一勺

</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content right"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0717 (5).jpg" onerror="this.onerror=null;this.src='/null'" alt="为AggVO批量设置单据行号"></div><div class="recent-post-info"><a class="article-title" href="/2025/05/16/250320/%E4%B8%BAAggVO%E6%89%B9%E9%87%8F%E8%AE%BE%E7%BD%AE%E5%8D%95%E6%8D%AE%E8%A1%8C%E5%8F%B7/" title="为AggVO批量设置单据行号"><div class="article-title-link">为AggVO批量设置单据行号</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-05-16T07:15:13.000Z" title="发表于 2025-05-16 15:15:13">2025-05-16</time></span></div></div></div><a class="article-content" href="/2025/05/16/250320/%E4%B8%BAAggVO%E6%89%B9%E9%87%8F%E8%AE%BE%E7%BD%AE%E5%8D%95%E6%8D%AE%E8%A1%8C%E5%8F%B7/" title="为AggVO批量设置单据行号"><div class="article-content-text">为AggVO批量设置单据行号
试了下，不太好用，行号是从 1 开始的。。。。。

nc.vo.pmpub.common.BillRowNoVOBillRowNoVO.setVOsRowNoByRule(CircularlyAccessibleValueObject[] baseVO, String billType, String key);aggvo数组， 单据类型 ， &quot;crowno&quot;

</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content left"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0717 (4).jpg" onerror="this.onerror=null;this.src='/null'" alt="生单时单据号重复"></div><div class="recent-post-info"><a class="article-title" href="/2025/05/16/250320/%E7%94%9F%E5%8D%95%E6%97%B6%E5%8D%95%E6%8D%AE%E5%8F%B7%E9%87%8D%E5%A4%8D/" title="生单时单据号重复"><div class="article-title-link">生单时单据号重复</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-05-16T06:21:13.000Z" title="发表于 2025-05-16 14:21:13">2025-05-16</time></span></div></div></div><a class="article-content" href="/2025/05/16/250320/%E7%94%9F%E5%8D%95%E6%97%B6%E5%8D%95%E6%8D%AE%E5%8F%B7%E9%87%8D%E5%A4%8D/" title="生单时单据号重复"><div class="article-content-text">生单时单据号重复
旭阳项目 ，在批量生成收款结算单时， 遇到一个问题，偶尔会生成 重复的单据号

原因批量生单， 在开启事务的一个接口里面，调用独立事务的方法，分别单独处理每一张收款结算单的保存，提交。         假如，处理完这些数据后，在 外层的接口里面，抛出错误，会导致 数据回滚，虽然单据的保存，提交是写在独立事务里面的，不会被回滚。         但是这一批单据，原本分配的  单据号， 会从缓存中被清理掉。 比如说， 单据号 1 2 3 4 ，12生成了单据， 34 保存失败，抛出错误，接口回滚。         下一批单据生成时，单据号并不是从 3 开始分配的，而是从 1 开始分配的。



所以，涉及到独立事务的情况， 最好让它的外层不要是接口。尤其是涉及到单据保存。

</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content right"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0717 (3).jpg" onerror="this.onerror=null;this.src='/null'" alt="杭加板材替代品差异数量调整"></div><div class="recent-post-info"><a class="article-title" href="/2025/05/16/250320/%E6%9D%AD%E5%8A%A0%E6%9D%BF%E6%9D%90%E6%9B%BF%E4%BB%A3%E5%93%81%E5%B7%AE%E5%BC%82%E6%95%B0%E9%87%8F%E8%B0%83%E6%95%B4/" title="杭加板材替代品差异数量调整"><div class="article-title-link">杭加板材替代品差异数量调整</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-05-16T01:20:31.000Z" title="发表于 2025-05-16 09:20:31">2025-05-16</time></span></div></div></div><a class="article-content" href="/2025/05/16/250320/%E6%9D%AD%E5%8A%A0%E6%9D%BF%E6%9D%90%E6%9B%BF%E4%BB%A3%E5%93%81%E5%B7%AE%E5%BC%82%E6%95%B0%E9%87%8F%E8%B0%83%E6%95%B4/" title="杭加板材替代品差异数量调整"><div class="article-content-text">杭加板材替代品差异数量调整需求说明介绍公司售卖板材产品时，会出现产品替代的业务；例如：销售订单约定为2000mm长度的板材产品，出库时因2000mm的产品没有库存，然后用1900mm长度的产品进行替代，但是结算需要按照2000mm长度产品的方量进行结算；因为不通长度规格的每块方量存在差异，所以替代时会导致出库结算方量【系统出库方量】和存量的方量出现差异，从而导致存量的方量出现异常，需要进行调整。例如: 销售订单约定，出库  11 X 1 m^2的 地砖 10 块，但是因为 库存量不足的原因，用  10 x 1 m^2的 地砖代替， 但是这样不能也给人家发货  10块，那样尺寸就少了 10m^2  所以得发货  11 块，  此时，销售出库单上， 实发数量是 10  差异调整数量(自定义项) 为 1  这是短替代长的场景。  还有长替代短的场景(差异调整数量是负数。)

//开发需求说明【销售出库】节点修改时自动生成【其他出库】，并且在【销售出库】删除、签字、取消签字操作是同步操作【其他出库】的数据和状态，处理前需判断状态如下：当【销售出库】明细物料所属的物料分类的【自定义项6】为是（Y ...</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content left"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0627 (6).jpg" onerror="this.onerror=null;this.src='/null'" alt="库存单据现存量查询"></div><div class="recent-post-info"><a class="article-title" href="/2025/05/12/250320/%E5%BA%93%E5%AD%98%E5%8D%95%E6%8D%AE%E7%8E%B0%E5%AD%98%E9%87%8F%E6%9F%A5%E8%AF%A2/" title="库存单据现存量查询"><div class="article-title-link">库存单据现存量查询</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-05-12T02:44:54.000Z" title="发表于 2025-05-12 10:44:54">2025-05-12</time></span></div></div></div><a class="article-content" href="/2025/05/12/250320/%E5%BA%93%E5%AD%98%E5%8D%95%E6%8D%AE%E7%8E%B0%E5%AD%98%E9%87%8F%E6%9F%A5%E8%AF%A2/" title="库存单据现存量查询"><div class="article-content-text">库存单据现存量查询修改保存时，重新 占用&#x2F;释放  现存量
业务规则触发的时机 ， 这个 OnhandBeforeUpdate  是前业务规则， 在BP里加 before 业务规则可以在 OnhandBeforeUpdate  之前触发，写before业务插件是在OnhandBeforeUpdate  之后触发

这个方法处于  OnhandBeforeUpdate 这个业务规则中

单据在保存或删除时，一般会先去  占用&#x2F;释放现存量，然后在后面去进行现存量的校验和计算。


try &#123;    // 这个并不是校验现存量的方法，而是  占用/释放 修改前VO 现存量的方法，  这里用在修改保存动作，传入的是修改前VO    // 如果是删除操作，这里传入的是删除前 VO。 如果是修改，这里传入的是 修改前VO，如果是插入，这里传入的是 null    //真正的计算，校验现存量是在 后续的  后业务规则    OnhandAfterUpdate 中            IOnhandUpdate onhand = (IOnhandUpdate)NCLoca ...</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content right"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0627 (4).jpg" onerror="this.onerror=null;this.src='/null'" alt="源发行版16需要目标发行版16"></div><div class="recent-post-info"><a class="article-title" href="/2025/04/27/250320/%E6%BA%90%E5%8F%91%E8%A1%8C%E7%89%8816%E9%9C%80%E8%A6%81%E7%9B%AE%E6%A0%87%E5%8F%91%E8%A1%8C%E7%89%8816/" title="源发行版16需要目标发行版16"><div class="article-title-link">源发行版16需要目标发行版16</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-04-27T02:03:42.000Z" title="发表于 2025-04-27 10:03:42">2025-04-27</time></span></div></div></div><a class="article-content" href="/2025/04/27/250320/%E6%BA%90%E5%8F%91%E8%A1%8C%E7%89%8816%E9%9C%80%E8%A6%81%E7%9B%AE%E6%A0%87%E5%8F%91%E8%A1%8C%E7%89%8816/" title="源发行版16需要目标发行版16"><div class="article-content-text">源发行版16需要目标发行版16

这里要对应上

</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content left"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0626 (6).jpg" onerror="this.onerror=null;this.src='/null'" alt="Failed to load ESAPI"></div><div class="recent-post-info"><a class="article-title" href="/2025/04/10/250320/Failed%20to%20load%20ESAPI/" title="Failed to load ESAPI"><div class="article-title-link">Failed to load ESAPI</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-04-10T01:40:19.000Z" title="发表于 2025-04-10 09:40:19">2025-04-10</time></span></div></div></div><a class="article-content" href="/2025/04/10/250320/Failed%20to%20load%20ESAPI/" title="Failed to load ESAPI"><div class="article-content-text">Failed to load ESAPI进入页面时报错：Failed to load ESAPI.properties as a classloader resource.

启动参数加上下面的参数

-Dorg.owasp.esapi.resources=$&#123;FIELD_NC_HOME&#125;/ierp/bin/esapi

</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content right"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0626 (4).jpg" onerror="this.onerror=null;this.src='/null'" alt="影像扫描"></div><div class="recent-post-info"><a class="article-title" href="/2025/03/28/250320/%E5%BD%B1%E5%83%8F%E6%89%AB%E6%8F%8F/" title="影像扫描"><div class="article-title-link">影像扫描</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-28T08:21:03.000Z" title="发表于 2025-03-28 16:21:03">2025-03-28</time></span></div></div></div><a class="article-content" href="/2025/03/28/250320/%E5%BD%B1%E5%83%8F%E6%89%AB%E6%8F%8F/" title="影像扫描"><div class="article-content-text">影像扫描提交时，进行影像扫描校验//先校验有没有开启影像扫描模块    boolean isimageused = InitGroupQuery.isEnabled(InvocationInfoProxy.getInstance().getGroupId(), &quot;1054&quot;); for (AggCtPuVO aggvo : vos) &#123; 	if (!isimageused) &#123; 		continue; 	&#125; 	/*  这里判断下，如果是 合同，则获取原始版本主键  这里为了解决合同变更后，一直到生效之前都是用的临时主键，这样会找不到变更之前的影像。  */ 	String pk_ct_pu = aggvo.getParentVO().getPrimaryKey(); 	String pk_origct = aggvo.getParentVO().getPk_origct(); 	if(StringUtils.isNotBlank(pk_origct)) &#123; 		pk_ct_pu = pk_origct; 	&#125; 	NC ...</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content left"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0626 (2).jpg" onerror="this.onerror=null;this.src='/null'" alt="查询用户是否拥有某职责"></div><div class="recent-post-info"><a class="article-title" href="/2025/03/28/250320/%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E6%8B%A5%E6%9C%89%E6%9F%90%E8%81%8C%E8%B4%A3/" title="查询用户是否拥有某职责"><div class="article-title-link">查询用户是否拥有某职责</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-28T02:09:44.000Z" title="发表于 2025-03-28 10:09:44">2025-03-28</time></span></div></div></div><a class="article-content" href="/2025/03/28/250320/%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E6%98%AF%E5%90%A6%E6%8B%A5%E6%9C%89%E6%9F%90%E8%81%8C%E8%B4%A3/" title="查询用户是否拥有某职责"><div class="article-content-text">查询用户是否拥有某职责   // java代码    Boolean flag = queryAuthorizationForBtn(userId, groupId);	if (!flag) &#123;		throw new BusinessException(&quot;当前用户没有该按钮使用权限！&quot;);	&#125;private Boolean queryAuthorizationForBtn(String userId, String groupId) throws BusinessException &#123;	Boolean ret = false;	StringBuilder buf = new StringBuilder();	buf.append(&quot; select count(*) from sm_user us &quot;);	buf.append(&quot; inner join sm_user_role ur on us.cuserid = ur.cuserid &quot;);	buf.append(&quot; inner joi ...</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content right"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogsEE240625 (17).png" onerror="this.onerror=null;this.src='/null'" alt="报错用户会话过期，请重新登录"></div><div class="recent-post-info"><a class="article-title" href="/2025/03/27/250320/%E6%8A%A5%E9%94%99%E7%94%A8%E6%88%B7%E4%BC%9A%E8%AF%9D%E8%BF%87%E6%9C%9F%EF%BC%8C%E8%AF%B7%E9%87%8D%E6%96%B0%E7%99%BB%E5%BD%95/" title="报错用户会话过期，请重新登录"><div class="article-title-link">报错用户会话过期，请重新登录</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-27T09:30:51.000Z" title="发表于 2025-03-27 17:30:51">2025-03-27</time></span></div></div></div><a class="article-content" href="/2025/03/27/250320/%E6%8A%A5%E9%94%99%E7%94%A8%E6%88%B7%E4%BC%9A%E8%AF%9D%E8%BF%87%E6%9C%9F%EF%BC%8C%E8%AF%B7%E9%87%8D%E6%96%B0%E7%99%BB%E5%BD%95/" title="报错用户会话过期，请重新登录"><div class="article-content-text">报错用户会话过期，请重新登录
解决办法://调用 接口或方法如果报 用户会话过期的错，就在前面加上这一行代码即可，不用改动，复制过去即可。NCLocator.getInstance().lookup(ISecurityTokenCallback.class).token(&quot;NCSystem&quot;.getBytes(),&quot;pfxx&quot;.getBytes());

</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content left"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogsEE240625 (16).png" onerror="this.onerror=null;this.src='/null'" alt="报错:Unresolved_compilation_problems"></div><div class="recent-post-info"><a class="article-title" href="/2025/03/21/250320/%E6%8A%A5%E9%94%99-Unresolved-compilation-problems/" title="报错:Unresolved_compilation_problems"><div class="article-title-link">报错:Unresolved_compilation_problems</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-21T05:46:41.000Z" title="发表于 2025-03-21 13:46:41">2025-03-21</time></span></div></div></div><a class="article-content" href="/2025/03/21/250320/%E6%8A%A5%E9%94%99-Unresolved-compilation-problems/" title="报错:Unresolved_compilation_problems"><div class="article-content-text">收款单提交报错：Unresolved_compilation_problems
报错信息:

Unresolved compilation problems:\tThe import nc.vo.pub.BusinessException cannot be resolved\tThe import nc.vo.pub.VOStatus cannot be resolved\tThe import nc.vo.pub.lang.UFDate cannot be resolved\tThe import nc.bs.framework.common.InvocationInfoProxy cannot be resolved\tThe import nc.bs.framework.common.NCLocator cannot be resolved\tNCLocator cannot be resolved\tBusinessException cannot be resolved to a type\tThe method queryEbankPayLogVO(String) fro ...</div></a><div class="recent-post-arrow"></div></div></div><div class="recent-post-item"><div class="recent-post-content right"><div class="recent-post-cover"><img class="article-cover" src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogsEE240625 (15).png" onerror="this.onerror=null;this.src='/null'" alt="63打开客户端报错，nc.sfbase.client.UILoader"></div><div class="recent-post-info"><a class="article-title" href="/2025/03/21/250220/63%E6%89%93%E5%BC%80%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8A%A5%E9%94%99%EF%BC%8Cnc-sfbase-client-UILoader/" title="63打开客户端报错，nc.sfbase.client.UILoader"><div class="article-title-link">63打开客户端报错，nc.sfbase.client.UILoader</div></a><div class="recent-post-meta">               <div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2025-03-21T02:55:29.000Z" title="发表于 2025-03-21 10:55:29">2025-03-21</time></span></div></div></div><a class="article-content" href="/2025/03/21/250220/63%E6%89%93%E5%BC%80%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8A%A5%E9%94%99%EF%BC%8Cnc-sfbase-client-UILoader/" title="63打开客户端报错，nc.sfbase.client.UILoader"><div class="article-content-text">解决NC63登陆客户端报错开发工具：eclipes633项目环境：NC63环境搭建：后端没有问题，启动客户端登录的时候报错：Error happend when load ‘nc.sfbase.client.UILoader’. Exception message:nc.bs.framework.server.ConfigMetaServiceImpl.getClientDispatchConfig()Lnc&#x2F;pub&#x2F;framework&#x2F;client&#x2F;dispatch&#x2F;ClientDispatchCfg;报错示例：
报错原因：没加载到包含的ConfigMetaServiceImpl.class
排查后发现环境中home&#x2F;external&#x2F;class中的ConfigMetaServiceImpl类代码没问题。
解决方法：使用环境中home&#x2F;external&#x2F;class中的ConfigMetaServiceImpl类的class文件，覆盖掉home&#x2F;bin目录下的fwserver.jar包中 ...</div></a><div class="recent-post-arrow"></div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/3/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/#content-inner">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/#content-inner">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/#content-inner">12</a><a class="extend next" rel="next" href="/page/5/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/%E5%A4%B4%E5%83%8F.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">beckoningcoco</div><div class="author-info__description">世界好吵，让我帮你捂耳朵吧</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">136</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/beckoningcoco"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/beckoningcoco" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:995587764@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的blog！</div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E6%97%97%E8%88%B0%E7%89%88%E8%B0%83%E7%94%A8openapi/" title="旗舰版调用openapi"><img src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0717 (2).jpg" onerror="this.onerror=null;this.src='/null'" alt="旗舰版调用openapi"/></a><div class="content"><a class="title" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E6%97%97%E8%88%B0%E7%89%88%E8%B0%83%E7%94%A8openapi/" title="旗舰版调用openapi">旗舰版调用openapi</a><time datetime="2025-07-22T10:03:32.000Z" title="发表于 2025-07-22 18:03:32">2025-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E6%97%97%E8%88%B0%E7%89%88%E5%8D%95%E6%8D%AE%E8%BD%AC%E6%8D%A2%E8%A7%84%E5%88%99%E8%8E%B7%E5%8F%96%E4%B8%8B%E6%B8%B8%E5%8D%95%E6%8D%AE%E5%AF%B9%E8%B1%A1/" title="旗舰版单据转换规则获取下游单据对象"><img src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0717 (1).png" onerror="this.onerror=null;this.src='/null'" alt="旗舰版单据转换规则获取下游单据对象"/></a><div class="content"><a class="title" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E6%97%97%E8%88%B0%E7%89%88%E5%8D%95%E6%8D%AE%E8%BD%AC%E6%8D%A2%E8%A7%84%E5%88%99%E8%8E%B7%E5%8F%96%E4%B8%8B%E6%B8%B8%E5%8D%95%E6%8D%AE%E5%AF%B9%E8%B1%A1/" title="旗舰版单据转换规则获取下游单据对象">旗舰版单据转换规则获取下游单据对象</a><time datetime="2025-07-22T09:54:04.000Z" title="发表于 2025-07-22 17:54:04">2025-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E6%97%97%E8%88%B0%E7%89%88%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1or%E8%B0%83%E5%BA%A6%E4%BB%BB%E5%8A%A1/" title="旗舰版后台任务or调度任务"><img src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0627 (2).jpg" onerror="this.onerror=null;this.src='/null'" alt="旗舰版后台任务or调度任务"/></a><div class="content"><a class="title" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E6%97%97%E8%88%B0%E7%89%88%E5%90%8E%E5%8F%B0%E4%BB%BB%E5%8A%A1or%E8%B0%83%E5%BA%A6%E4%BB%BB%E5%8A%A1/" title="旗舰版后台任务or调度任务">旗舰版后台任务or调度任务</a><time datetime="2025-07-22T09:33:52.000Z" title="发表于 2025-07-22 17:33:52">2025-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E5%AE%A1%E6%A0%B8%E5%90%8E-%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0%E6%8F%92%E4%BB%B6/" title="审核后_扩展函数插件"><img src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0627 (1).jpg" onerror="this.onerror=null;this.src='/null'" alt="审核后_扩展函数插件"/></a><div class="content"><a class="title" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E5%AE%A1%E6%A0%B8%E5%90%8E-%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0%E6%8F%92%E4%BB%B6/" title="审核后_扩展函数插件">审核后_扩展函数插件</a><time datetime="2025-07-22T09:22:46.000Z" title="发表于 2025-07-22 17:22:46">2025-07-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E4%B8%8B%E6%8E%A8%E5%8D%95%E6%8D%AE%E6%97%B6%EF%BC%8C%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%BB%99%E4%B8%8B%E6%B8%B8%E5%8D%95%E6%8D%AE%E8%84%9A%E6%9C%AC/" title="下推单据时，传递参数给下游单据脚本"><img src="https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogs0627 (15).jpg" onerror="this.onerror=null;this.src='/null'" alt="下推单据时，传递参数给下游单据脚本"/></a><div class="content"><a class="title" href="/2025/07/22/%E6%97%97%E8%88%B0%E7%89%88/%E4%B8%8B%E6%8E%A8%E5%8D%95%E6%8D%AE%E6%97%B6%EF%BC%8C%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E7%BB%99%E4%B8%8B%E6%B8%B8%E5%8D%95%E6%8D%AE%E8%84%9A%E6%9C%AC/" title="下推单据时，传递参数给下游单据脚本">下推单据时，传递参数给下游单据脚本</a><time datetime="2025-07-22T08:32:28.000Z" title="发表于 2025-07-22 16:32:28">2025-07-22</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分类</span>
            
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring/"><span class="card-category-list-name">Spring</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/javaFX/"><span class="card-category-list-name">javaFX</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>标签</span></div><div class="card-tag-cloud"><a href="/tags/JAVA/" style="font-size: 1.1em; color: #999">JAVA</a> <a href="/tags/JavaFX/" style="font-size: 1.1em; color: #999">JavaFX</a> <a href="/tags/Linux/" style="font-size: 1.1em; color: #999">Linux</a> <a href="/tags/NCC%E4%B8%9A%E5%8A%A1%E6%93%8D%E4%BD%9C/" style="font-size: 1.1em; color: #999">NCC业务操作</a> <a href="/tags/NCC%E5%BC%80%E5%8F%91/" style="font-size: 1.5em; color: #99a9bf">NCC开发</a> <a href="/tags/NCC%E7%B3%BB%E7%BB%9F%E6%93%8D%E4%BD%9C/" style="font-size: 1.1em; color: #999">NCC系统操作</a> <a href="/tags/NCC%E8%BF%90%E7%BB%B4/" style="font-size: 1.1em; color: #999">NCC运维</a> <a href="/tags/Node/" style="font-size: 1.1em; color: #999">Node</a> <a href="/tags/React/" style="font-size: 1.4em; color: #99a5b6">React</a> <a href="/tags/React%E7%BB%84%E4%BB%B6/" style="font-size: 1.1em; color: #999">React组件</a> <a href="/tags/Spring/" style="font-size: 1.3em; color: #99a1ac">Spring</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 1.1em; color: #999">前端</a> <a href="/tags/%E5%B0%8F%E8%AF%B4%E7%B4%A0%E6%9D%90/" style="font-size: 1.1em; color: #999">小说素材</a> <a href="/tags/%E5%B9%B2%E9%A5%AD/" style="font-size: 1.2em; color: #999da3">干饭</a> <a href="/tags/%E6%97%97%E8%88%B0%E7%89%88/" style="font-size: 1.4em; color: #99a5b6">旗舰版</a> <a href="/tags/%E6%97%97%E8%88%B0%E7%89%88%E5%BC%80%E5%8F%91/" style="font-size: 1.1em; color: #999">旗舰版开发</a> <a href="/tags/%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85/" style="font-size: 1.1em; color: #999">软件安装</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><span class="card-archive-list-count">10</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><span class="card-archive-list-count">21</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><span class="card-archive-list-count">11</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/02/"><span class="card-archive-list-date">二月 2025</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><span class="card-archive-list-count">12</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">136</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2025-07-23T06:38:36.756Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://img-for-blogs.oss-cn-beijing.aliyuncs.com/img-for-blogsEE240625 (8).jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2025 By beckoningcoco</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">嘘声是给予挑战者的勋章——美浦波旁.<p><a target="_blank" href="https://hexo.io/"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&logo=hexo" title="博客框架为Hexo"></a>&nbsp;<a target="_blank" href="https://butterfly.js.org/"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&logo=bitdefender" title="主题采用butterfly"></a>&nbsp;<a target="_blank" href="https://www.jsdelivr.com/"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&logo=jsDelivr" title="本站使用JsDelivr为静态资源提供CDN加速"></a> &nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Vervel-brightgreen?style=flat&logo=Vercel" title="本站采用双线部署，默认线路托管于Vercel"></a>&nbsp;<a target="_blank" href="https://vercel.com/ "><img src="https://img.shields.io/badge/Hosted-Coding-0cedbe?style=flat&logo=Codio" title="本站采用双线部署，联通线路托管于Coding"></a>&nbsp;<a target="_blank" href="https://github.com/"><img src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&logo=GitHub" title="本站项目由Gtihub托管"></a>&nbsp;<a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&logo=Claris" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i><span id="percent">0<span>%</span></span></button><button id="go-down" type="button" title="直达底部" onclick="btf.scrollToDest(document.body.scrollHeight, 500)"><i class="fas fa-arrow-down"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["市井皆是温柔，弄堂藏匿浪漫","白茶清风无别事，我在等风也在等你","早餐店的老板娘问我要什么，我说，我要肆意妄为，要志得意满，要遨游山川湖海，要世界上的所有烂漫，开个玩笑，我长大了，我是说...我要豆浆和油条","要大笑，要做梦，要与众不同 ——  外婆的道歉信"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '市井皆是温柔，弄堂藏匿浪漫'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>